---
// src/components/banners/FeatureCarousal.astro
import FeatureBanner, { type FeatureBannerProps } from './FeatureBanner.astro';
import PromoBanner from './PromoBanner.astro';
import type { PromoBannerProps } from '@components/banners/PromoBanner.astro';
import { Image } from 'astro:assets';

import multipleAccountsImage from '@assets/images/features/accounts-feature.webp';
import transferImage from '@assets/images/features/transfer-feature.webp';
import walletPromoImage from '@assets/images/promos/wallet-promo.webp';

// Prepare carousel items for rendering
const carouselItems: (FeatureBannerProps | PromoBannerProps)[] = [
  {
    title: 'Multiple accounts. All your money. One super-app.',
    subtitle: 'Manage all your finances in a single place',
    backgroundColor: 'bg-gradient-to-br from-teal-400 via-green-400 to-teal-400', // Green
    textColor: '#000000',
    imageSrc: multipleAccountsImage,
    imageAlt: 'Multiple accounts feature',
    type: 'feature',
  },
  {
    heading: 'Earn up to 2000 PKR',
    description: 'Complete your registration and Earn. It takes less than 5min.',
    backgroundColor: 'bg-[radial-gradient(ellipse_50.00%_50.00%_at_50.00%_50.00%,_#8744D4_0%,_#6526AE_100%)]',
    textColor: '#FFFFFF',
    imageSrc: walletPromoImage,
    imageAlt: 'Earn bonus promotion',
    type: 'promo',
  },
  {
    title: 'Instantly transfer money',
    subtitle: 'Fast and secure transfers to anyone, anywhere',
    backgroundColor: 'bg-[radial-gradient(ellipse_115.42%_113.13%_at_15.59%_27.82%,_#31B3FB_0%,_#137EC5_100%)]',
    textColor: '#FFFFFF',
    imageSrc: transferImage,
    imageAlt: 'Transfer money feature',
    type: 'feature',
  },
  {
    title: 'Multiple accounts. All your money. One super-app.',
    subtitle: 'Manage all your finances in a single place',
    backgroundColor: 'bg-gradient-to-br from-teal-400 via-green-400 to-teal-400', // Green
    textColor: '#000000',
    imageSrc: multipleAccountsImage,
    imageAlt: 'Multiple accounts feature',
    type: 'feature',
  },
  {
    heading: 'Earn up to 2000 PKR',
    description: 'Complete your registration and Earn. It takes less than 5min.',
    backgroundColor: 'bg-[radial-gradient(ellipse_50.00%_50.00%_at_50.00%_50.00%,_#8744D4_0%,_#6526AE_100%)]',
    textColor: '#FFFFFF',
    imageSrc: walletPromoImage,
    imageAlt: 'Earn bonus promotion',
    type: 'promo',
  },
  {
    title: 'Instantly transfer money',
    subtitle: 'Fast and secure transfers to anyone, anywhere',
    backgroundColor: 'bg-[radial-gradient(ellipse_115.42%_113.13%_at_15.59%_27.82%,_#31B3FB_0%,_#137EC5_100%)]',
    textColor: '#FFFFFF',
    imageSrc: transferImage,
    imageAlt: 'Transfer money feature',
    type: 'feature',
  },
];
---

<section class='flex justify-center py-16'>
  <div class='container'>
    <h2 class='mb-10 text-3xl font-bold text-center'>Why Choose Jingle Pay</h2>

    <!-- Swiper container -->
    <div class='swiper feature-carousel'>
      <!-- Swiper wrapper -->
      <div class='swiper-wrapper'>
        {
          carouselItems.map((item) => (
            <div class='swiper-slide'>
              {item.type === 'feature' ? (
                <FeatureBanner {...(item as FeatureBannerProps)}>
                  <Image src={item.imageSrc} alt={item.imageAlt} class='w-auto h-60' />
                </FeatureBanner>
              ) : (
                <PromoBanner {...(item as PromoBannerProps)}>
                  <Image src={item.imageSrc} alt={item.imageAlt} class='w-auto h-60' />
                </PromoBanner>
              )}
            </div>
          ))
        }
      </div>
    </div>
  </div>
</section>

<!-- Import Swiper CSS -->
<link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css' />

<!-- Import Swiper JS and initialize -->
<script>
  import Swiper from 'swiper';
  import { Navigation, Pagination, Autoplay, EffectCoverflow } from 'swiper/modules';
  import 'swiper/css';
  import 'swiper/css/navigation';
  import 'swiper/css/pagination';
  import 'swiper/css/effect-coverflow';

  document.addEventListener('DOMContentLoaded', () => {
    const swiper = new Swiper('.feature-carousel', {
      modules: [Navigation, Pagination, Autoplay, EffectCoverflow],

      // Adjust these settings to fix the layout
      slidesPerView: 1.5, // Show 1.5 slides instead of 'auto'
      centeredSlides: true,
      initialSlide: 2,

      // Reduce space between slides
      spaceBetween: 125,
      loop: true,

      // Adjust coverflow effect
      effect: 'coverflow',
      coverflowEffect: {
        rotate: 0,
        stretch: 50, // Increase stretch to 50
        depth: 150, // Increase depth to 200
        modifier: 1, // Increase modifier to 2
        slideShadows: false,
      },

      // Autoplay
      autoplay: {
        delay: 5000,
        disableOnInteraction: false,
        reverseDirection: true,
      },
    });
  });
</script>

<!-- Add additional styling -->
<style></style>
