---
// src/components/common/ServerQRCode.astro
import QRCode from 'qrcode';
import { Image } from 'astro:assets';

interface Props {
  size?: number;
}

const { size = 50 } = Astro.props;
const siteUrl = import.meta.env.DEV
  ? 'http://localhost:4321'
  : 'http://jinglepay-website-dev.s3-website.me-central-1.amazonaws.com';
const redirectUrl = `${siteUrl}/app-redirect`;

// Generate QR code as a data URL
const qrCodeDataURL = await QRCode.toDataURL(redirectUrl, {
  width: size,
  margin: 1,
});
---

<Image
  inferSize
  src={qrCodeDataURL}
  alt='App Download QR Code'
  widths={[65, 80]}
  sizes='(max-width: 575px) 65px, 80px'
  class='w-[65px] sm:w-[80px]'
/>
