---
import QRCode from 'qrcode';

interface Props {
  baseGenerationSize?: number;
}

const { baseGenerationSize = 120 } = Astro.props;

const siteUrl =
  import.meta.env.PUBLIC_SITE_URL ||
  (import.meta.env.DEV
    ? 'http://localhost:4321'
    : // TODO: Remove this after deployment
      'http://jinglepay-website-dev.s3-website.me-central-1.amazonaws.com/');

const redirectUrl = `${siteUrl}/app-redirect`;

const qrCodeDataURL = await QRCode.toDataURL(redirectUrl, {
  width: baseGenerationSize,
  margin: 1,
  errorCorrectionLevel: 'M',
});
---

<img src={qrCodeDataURL} alt='App Download QR Code' class='w-[65px] sm:w-[80px]' loading='lazy' decoding='async' />
