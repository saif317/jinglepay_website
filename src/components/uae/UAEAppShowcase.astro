---
/**
 * UAE App Showcase Section â€“ "Go-to app for everyday finances"
 * Displays 4 app screen mock-ups with even spacing to showcase the app features.
 */
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

// Import phone screen images with explicit typing
import phone1 from '@assets/uae/phone-set/phone1.png';
import phone2 from '@assets/uae/phone-set/phone2.png';
import phone3 from '@assets/uae/phone-set/phone3.png';
import phone4 from '@assets/uae/phone-set/phone4.png';

// Define constants for image sizing
const phoneWidths = [210, 420];
const phoneSizes = '(max-width: 768px) 210px, 210px';

// Create phone objects for easier mapping
interface PhoneDisplay {
  image: ImageMetadata;
  alt: string;
  title: string;
}

// Create an array of phones with their details
const phones: PhoneDisplay[] = [
  {
    image: phone1,
    alt: 'JinglePay app - Add funds screen',
    title: 'Add Funds',
  },
  {
    image: phone2,
    alt: 'JinglePay app - Send Money screen',
    title: 'Send Money',
  },
  {
    image: phone3,
    alt: 'JinglePay app - Request Money screen',
    title: 'Request Money',
  },
  {
    image: phone4,
    alt: 'JinglePay app - Split screen',
    title: 'Split',
  },
];

// Get translations
const { appShowcase } = Astro.locals.translations;

// Helper function to calculate vertical offset for piano tile effect
function getOffsetForIndex(index: number): number {
  // Create a staggered effect
  // First and third phones are higher, second and fourth are lower
  // Different offsets for different screen sizes, controlled by CSS
  const baseOffsets = [-135, -15, -100, 10];

  // Scale the offsets based on screen size using CSS variables
  return baseOffsets[index] || 0;
}
---

<section
  class='w-full px-4 sm:px-6 md:px-8 lg:px-[100px] xl:px-[152px] pb-16 sm:pb-20 md:pb-24 lg:pb-[100px] xl:pb-[114px]'
>
  <div class='flex flex-col gap-[72px] mx-auto max-w-7xl xl:flex-row xl:items-center xl:justify-between'>
    <div
      class='relative w-full max-w-[320px] sm:max-w-[400px] md:max-w-[500px] lg:max-w-[568px] translate-y-0 sm:translate-y-[-2rem] md:translate-y-[-4rem] lg:translate-y-[-8rem] scale-100 sm:scale-[0.8] md:scale-[0.9] lg:scale-[1.1] h-[420px] sm:h-[350px] md:h-[400px] lg:h-[500px] mx-auto xl:w-full'
    >
      <!-- Circular background for phones -->
      <div
        class='absolute top-1/2 xs:top-[12rem] sm:top-[14rem] md:top-[16rem] lg:top-[20rem] left-1/2 -translate-x-1/2 -translate-y-1/2 w-[90vw] xs:w-[80vw] sm:w-[440px] md:w-[520px] lg:w-[573px] aspect-square max-w-[320px] sm:max-w-[573px] bg-[radial-gradient(ellipse_50%_50%_at_50%_50%,_#F3F5F6_0%,_#F3F5F6_100%)] rounded-full z-0'
      >
      </div>

      <!-- Phone screens arrangement - piano tile/staggered layout -->
      <div class='relative z-10 flex items-end justify-center h-full gap-2 xs:gap-3 sm:gap-4 md:gap-5 lg:gap-6'>
        <!-- Phones with staggered positioning like piano keys -->
        {
          phones.map((phone, index) => (
            <div
              class='overflow-hidden bg-white shadow-lg'
              style={`transform: translateY(${getOffsetForIndex(index)}px);`}
            >
              <Image
                src={phone.image}
                alt={phone.alt}
                width={210}
                height={430}
                class='w-[120px] xs:w-[130px] sm:w-[140px] md:w-[170px] lg:w-[210px] h-auto'
                widths={phoneWidths}
                sizes={phoneSizes}
                loading={index <= 1 ? 'eager' : 'lazy'}
                decoding={index <= 1 ? 'sync' : 'async'}
                quality='max'
              />
            </div>
          ))
        }
      </div>
    </div>

    <div class='max-w-[600px] mx-auto xl:w-[45%] px-4 xl:px-0 text-center xl:text-start'>
      <h2 class='mb-4 sm:mb-6 text-2xl sm:text-3xl md:text-4xl font-extrabold text-gray-900 font-["Hero_New"]'>
        {appShowcase?.heading.prefix}<br />
        {appShowcase?.heading.highlight}
      </h2>
      <div class='flex flex-col gap-2 sm:gap-3 md:gap-4'>
        {
          (
            appShowcase?.features || [
              'No minimum balance is required.',
              'Earn +10% profit on savings.',
              'Multiple transactions are available, including utility bill payments, mobile top-ups, and fund transfers.',
            ]
          ).map((feature: string, idx: number) => {
            return (
              <p
                class={`text-base sm:text-lg md:text-xl text-gray-900 font-["DM_Sans"] ${idx === 1 ? 'font-bold' : 'font-normal'}`}
                set:html={feature}
              />
            );
          })
        }
      </div>
    </div>
  </div>
</section>
